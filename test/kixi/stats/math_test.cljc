(ns kixi.stats.math-test
  (:require [kixi.stats.math :as sut]
            #?@(:cljs
                [[cljs.test :refer-macros [is deftest]]]
                :clj
                [[clojure.test :refer [is deftest]]])))

(def known-gammas
  [1.0 0.9417426998497015 0.906402477055477 0.8889135691562253
   0.886226925452758 0.8965742800565979 0.9190625268488833
   0.9534458127450349 1.0 1.0594605373309143
   1.1330030963193463 1.2222561575898099 1.329340388179137
   1.4569332050919717 1.6083594219855457 1.7877108988969403
   2.0 2.2513536418281928 2.5492569667185294
   2.9028583742757985 3.3233509704478426 3.8244496633664258
   4.422988410460251 5.139668834328703 6.0
   7.035480130713102 8.28508514183522 9.79714701318082
   11.631728396567448 13.863630029703293 16.58620653922594
   19.916216733023727 24.0 29.021355539191546
   35.211611852799685 42.862518182666086 52.34277778455352
   64.11928888737773 78.78448106132322 97.09155657349066
   120.0 148.73444713835667 184.86096222719834
   230.38603523183022 287.88527781504433 360.67099999149974
   453.0107661026085 570.4128948692577 720.0
   910.9984887224347 1155.3810139199898 1468.7109746029178
   1871.2543057977882 2389.4453749436857 3057.8226711926072
   3921.5886522261467 5040.0 6490.864232147347
   8376.512350919926 10831.743437696518 14034.407293483411
   18219.520983945604 23698.12570174271 30882.510636280906
   40320.0 52738.271886197195 69106.22689508938
   90715.85129070834 119292.46199460901 157143.36848653082
   207358.5998902487 274082.281896993])

(deftest gamma-matches-known-values []
  (is (= 1.0 (sut/gamma 1)))
  (is (= 1.0 (sut/gamma 2)))
  (is (= 2.0 (sut/gamma 3)))
  (is (= 6.0 (sut/gamma 4)))
  (is (= 24.0 (sut/gamma 5)))
  (is (= 120.0 (sut/gamma 6)))
  (is (= 720.0 (sut/gamma 7)))
  (is (= 5040.0 (sut/gamma 8)))
  (is (= known-gammas
         (mapv sut/gamma (range 1 10 0.125)))))

